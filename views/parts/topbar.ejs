<!-- ========== header start ========== -->
<style>
  .progress {
      height: 20px;
      border-radius: 10px;
  }
  .progress-bar {
      border-radius: 10px;
  }
  .progress-bar-belum {
      background-color: #FF6781;
  }
  .progress-bar-sudah {
      background-color: #78FF81;
  }
  .progress-container {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 10px 0;
  }
  .progress-text {
      display: flex;
      align-items: center;
      font-size: 16px;
  }
  .progress-text img {
      margin-right: 5px;
  }
  .progress-text span {
      font-weight: bold;
  }
  .card-title {
    margin-bottom: 0.5rem;
  }
  .p-4 {
    padding-top: 0.5rem !important;
  }
  /* .column-flex {
    display: flex;
    flex-direction: column;
    justify-content: space-between;
  } */

  @media (min-width: 562px) { 
    .column-flex {
      display: flex;
      flex-direction: column;
      justify-content: space-between;
    }
  }
</style>
<header class="header">
    <div class="container-fluid">
        <div class="row align-items-center">
            <div class="col-lg-3 col-md-6 col-sm-6 col-6">
                <img src="/assets/images/logo/new-logo.png" alt="Company Logo" class="header-logo"/>
            </div>
            <div class="header-title col-lg-6 col-md-6 col-sm-12 col-12 text-center">
                <h1>Aplikasi Pengumpulan Sampah</h1>
            </div>
            <div class="col-lg-3 col-md-6 col-sm-6 col-6">
                <div class="header-right">
                  <!-- profile start -->
                  <div class="profile-box">
                    <button class="dropdown-toggle bg-transparent border-0" type="button" id="profile"
                            data-bs-toggle="dropdown" aria-expanded="false">
                      <div class="profile-info">
                        <div class="info">
                          <div class="image">
                            <img src="/assets/images/profile/profile-image.png" alt="" />
                          </div>
                          <div>
                            <h6 class="fw-500"><%= locals.login.USER_NAME%></h6>
                            <p><%= locals.login.ROLE_NAME%></p>
                          </div>
                        </div>
                      </div>
                    </button>
                    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="profile">
                      <li>
                        <div class="author-info flex items-center !p-1">
                          <div class="image">
                            <img src="/assets/images/profile/profile-image.png" alt="image">
                          </div>
                          <div class="content">
                            <h4 class="text-sm"><%= login.USER_NAME%></h4>
                            <a class="text-black/40 dark:text-white/40 hover:text-black dark:hover:text-white text-xs" href="#"><%= locals.login.ROLE_NAME%></a>
                          </div>
                        </div>
                      </li>
                      <li class="divider"></li>
                      <li>
                        <a href="#">
                          <i class="lni lni-user"></i> View Profile
                        </a>
                      </li>
                      <li>
                        <a href="#">
                          <i class="lni lni-alarm"></i> Notifications
                        </a>
                      </li>
                      <li>
                        <a href="#"> <i class="lni lni-inbox"></i> Messages </a>
                      </li>
                      <li>
                        <a href="#"> <i class="lni lni-cog"></i> Settings </a>
                      </li>
                      <li class="divider"></li>
                      <li>
                        <a href="/signin/signout"> <i class="lni lni-exit"></i> Sign Out </a>
                      </li>
                    </ul>
                  </div>
                  <!-- profile end -->
                </div>
            </div>              
        </div>
    </div>
</header>


<!-- ========== header end ========== -->
<!-- ========== nav start ============-->
<nav class="mb-4">
  <div class="container-fluid">
      <div class="row">
          <div class="col">
              <div class="title-wrapper pt-30 pb-3">
                  <h4 class="nav-title fw-500 text-gray shadow-text"><i>Hi, <%= locals.login.USER_NAME%></i></h4>
              </div>
          </div>
      </div>
      <div class="row">
        <div class="col-auto column-flex">
            <div class="card" style="display: inline-block; background: #FFB678; color: black;">
                <div class="card-body">
                    <h3 class="card-title">Welcome to Rizqi Semesta</h3>
                </div>
            </div>
            <% if (view.page === 'home-pekerja') { %>
              <div class="mt-4 mt-sm-0 mb-2 mb-sm-0">
                <h4 class=" fw-500 text-gray shadow-text">Data Sampah Keseluruhan:</h4>
              </div>
            <% } %>
        </div>
        <% if (view.page === 'home-pekerja' || view.page === 'home-admin') { %>
          <div class="col w-100">
            <div class="card card-gray-bg" style="color: black;">
                <div class="px-2">
                  <div class="card-body">
                    <h5 class="card-title"><b>User yang sudah mengumpulkan sampah</b></h5>
                  </div>
                </div>
                <div class="p-4">
                  <div class="progress" id="progress-bar">
                    <div class="progress-bar progress-bar-belum" role="progressbar" id="progress-bar-belum" aria-valuemin="0" aria-valuemax="100"></div>
                    <div class="progress-bar progress-bar-sudah" role="progressbar" id="progress-bar-sudah" aria-valuemin="0" aria-valuemax="100"></div>
                  </div>
                </div>
              <div class="progress-container px-4">
                  <div class="progress-text" id="text-belum">
                      <img src="https://img.icons8.com/color/20/000000/sad.png" alt="Belum Icon">
                      <span style="color: #FF6781;">Belum <span id="belum-count">0</span></span>
                  </div>
                  <div class="progress-text" id="text-sudah">
                      <span style="color: #78FF81;">Sudah <span id="sudah-count">0</span></span>
                      <img src="https://img.icons8.com/color/20/000000/happy.png" alt="Sudah Icon">
                  </div>
              </div>
            </div>
          </div>
        <% } %>
      </div>
  </div>
</nav>
<% if (view.page === 'home-pekerja' || view.page === 'home-admin') { %>
  <script>
    $(document).ready(function() {
        function fetchProgressData() {
            $.ajax({
                url: '/sampah/data-user-per-minggu',
                method: 'GET',
                success: function(response) {
                  const total = response.belum + response.sudah;
                  const belumPercent = (response.belum / total) * 100;
                  const sudahPercent = (response.sudah / total) * 100;
                  
                  $('#progress-bar-belum').css('width', belumPercent + '%').attr('aria-valuenow', belumPercent);
                  $('#progress-bar-sudah').css('width', sudahPercent + '%').attr('aria-valuenow', sudahPercent);
                  $('#belum-count').text(response.belum);
                  $('#sudah-count').text(response.sudah.toLocaleString());
                },
                error: function(error) {
                  console.error('Error fetching progress data:', error);
                }
            });
        }

        fetchProgressData();
    });
  </script>
<% } %>